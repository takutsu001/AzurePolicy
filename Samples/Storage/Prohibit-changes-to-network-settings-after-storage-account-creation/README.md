# ストレージアカウント作成後のネットワーク設定変更を禁止する

> [!NOTE]
> 本説明はChatGPTを利用して作成しています

## ポリシーの説明
このポリシーは、ストレージアカウントのパブリックネットワークアクセスが有効になっている場合に、特定のネットワーク設定を強制するものです。ポリシーが適用されると、特定の条件下でのみ、ネットワークアクセスが許可されるように制限されます。

## ポリシーの目的
このポリシーの目的は、ストレージアカウントのパブリックネットワークアクセスを制限し、特定のIPアドレスにのみアクセスを許可することで、セキュリティを強化することです。また、変更には特定の権限が必要であるため、誤った設定変更が行われるリスクを低減します。

## コードの説明
- モード: Indexed – インデックス付きのリソースに対してポリシーを適用します。
- 条件 (if セクション):
    - リソースの種類が Microsoft.Storage/storageAccounts であることを確認します。
    - ストレージアカウントのパブリックネットワークアクセスが Enabled（有効）である場合に適用されます。
- 処理 (then セクション):
    - ポリシーの適用効果は parameters('effect') に基づいて決定されます。例えば、Deny または Audit などの効果を持たせることができます。
    - roleDefinitionIds で指定されたロールが必要です。このロールは、ポリシーによる設定変更を許可するために必要な権限を定義します。
    - コンフリクトが発生した場合は audit（監査）を行い、ログに記録します。
    - 操作 (operations セクション) には、以下の2つの設定が含まれます:
    - networkAcls.defaultAction を Deny に設定し、すべてのネットワークからのアクセスを無効にします。
    - 指定されたIPアドレス（例: 1.1.1.1 および 2.2.2.2）をネットワークアクセスの許可リストに追加します。